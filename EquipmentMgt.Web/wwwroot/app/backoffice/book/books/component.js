"use strict";var __decorate=this&&this.__decorate||function(e,o,t,r){var i,a=arguments.length,l=a<3?o:null===r?r=Object.getOwnPropertyDescriptor(o,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,o,t,r);else for(var n=e.length-1;0<=n;n--)(i=e[n])&&(l=(a<3?i(l):3<a?i(o,t,l):i(o,t))||l);return 3<a&&l&&Object.defineProperty(o,t,l),l},__metadata=this&&this.__metadata||function(e,o){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,o)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),forms_1=require("@angular/forms"),http_1=require("@angular/http"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),service_1=require("../../../shared/service"),BooksComponent=function(){function e(e,o,t,r,i){this._http=e,this.router=o,this.titleService=t,this.formBuilder=r,this._dataService=i,this.loading=!1,this._getUrl="/api/book/getAll",this._getbyIdUrl="/api/book/getById",this._saveUrl="/api/book/save",this._deleteUrl="/api/book/deleteById",this._getcalibrationUrl="/api/dropdown/getAllCalibration",this._getcategoryUrl="/api/dropdown/getAllcategory"}return e.prototype.ngOnInit=function(){this.titleService.setTitle("Envanter Takip Sistemi | Cihazlar"),this.createForm(),this.getAll()},e.prototype.createForm=function(){this.bookForm=this.formBuilder.group({id:0,bookName:new forms_1.FormControl("",forms_1.Validators.required),calibrationId:new forms_1.FormControl("",forms_1.Validators.required),category:new forms_1.FormControl("",forms_1.Validators.required),description:new forms_1.FormControl(""),fileupload:null})},e.prototype.addNew=function(){$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#bookName").focus()}),this.reset(),this.getcalibration(),this.getcategory()},e.prototype.getAll=function(){var o=this;this._dataService.getAll(this._getUrl).subscribe(function(e){o.books=e},function(e){console.log(e)})},e.prototype.edit=function(e,o){var t=this;e.preventDefault(),this.getcalibration(),this.getcategory(),this._dataService.getById(o.id,this._getbyIdUrl).subscribe(function(e){t.book=e,t.bookForm.setValue({id:t.book.id,bookName:t.book.bookname,calibrationId:t.book.calibrationId,category:t.book.category,description:t.book.description,fileupload:t.book.coverimage}),$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#bookName").focus()})},function(e){console.log(e)})},e.prototype.onFileChange=function(e){0<e.target.files.length&&(e=e.target.files[0],this.bookForm.get("fileupload").setValue(e))},e.prototype.onSubmit=function(){var e,o=this;this.bookForm.invalid||((e=new FormData).append("id",this.bookForm.value.id),e.append("bookName",this.bookForm.value.bookName),e.append("calibrationId",this.bookForm.value.calibrationId),e.append("category",this.bookForm.value.category),e.append("description",this.bookForm.value.description),e.append("fileupload",this.bookForm.value.fileupload),this._dataService.saveForm(e,this._saveUrl).subscribe(function(e){o.resmessage=e.message,o.alertmessage="alert-outline-info",o.getAll(),o.reset()},function(e){console.log(e)}))},e.prototype.delete=function(e,o){var t=this;e.preventDefault(),confirm("You are about to delete "+o.bookname+". Are you sure?")&&this._dataService.delete(o.id,this._deleteUrl).subscribe(function(e){t.resmessage=e,t.getAll()},function(e){console.log(e)})},e.prototype.getcalibration=function(){var o=this;this._dataService.getAll(this._getcalibrationUrl).subscribe(function(e){o.calibrations=e},function(e){console.log(e)})},e.prototype.getcategory=function(){var o=this;this._dataService.getAll(this._getcategoryUrl).subscribe(function(e){console.log(e),o.categories=e},function(e){console.log(e)})},e.prototype.reset=function(){this.bookForm.setValue({id:0,bookName:null,calibrationId:"",category:"",description:null,fileupload:null}),this.fileInput.nativeElement.value="",this.resmessage=null,$("#bookName").focus()},__decorate([core_1.ViewChild("fileInput"),__metadata("design:type",core_1.ElementRef)],e.prototype,"fileInput",void 0),__decorate([core_1.Component({selector:"ng-books",templateUrl:"./app/backoffice/book/books/component.html",providers:[service_1.DataService]}),__metadata("design:paramtypes",[http_1.Http,router_1.Router,platform_browser_1.Title,forms_1.FormBuilder,service_1.DataService])],e)}();exports.BooksComponent=BooksComponent;
