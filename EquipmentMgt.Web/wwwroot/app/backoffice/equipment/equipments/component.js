"use strict";var __decorate=this&&this.__decorate||function(e,t,i,o){var r,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,o);else for(var a=e.length-1;0<=a;a--)(r=e[a])&&(s=(n<3?r(s):3<n?r(t,i,s):r(t,i))||s);return 3<n&&s&&Object.defineProperty(t,i,s),s},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),forms_1=require("@angular/forms"),http_1=require("@angular/http"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),service_1=require("../../../shared/service"),EquipmentsComponent=function(){function e(e,t,i,o,r){this._http=e,this.router=t,this.titleService=i,this.formBuilder=o,this._dataService=r,this.loading=!1,this._getUrl="/api/equipment/getAll",this._getbyIdUrl="/api/equipment/getById",this._saveUrl="/api/equipment/save",this._deleteUrl="/api/equipment/deleteById",this._getbyEquipmentIdUrl="/api/equipment/getByText",this._updateUrl="/api/equipment/updateStatus",this._getCalibrationUrl="/api/calibration/getAll",this._getLocationUrl="/api/location/getAll",this._getEquipmentModelUrl="/api/equipmentmodel/getAll",this._getUserUrl="/api/users/getAll",this.loggedUser=JSON.parse(localStorage.getItem("loggedUser"))}return e.prototype.ngOnInit=function(){this.titleService.setTitle("Envanter Takip Sistemi | Cihazlar"),this.createForm(),this.getAll()},e.prototype.createForm=function(){this.equipmentForm=this.formBuilder.group({id:0,equipmentId:new forms_1.FormControl("",forms_1.Validators.required),calibrationId:new forms_1.FormControl("",forms_1.Validators.required),equipmentName:new forms_1.FormControl("",forms_1.Validators.required),serialPortUSB:new forms_1.FormControl("",forms_1.Validators.required),permanentLocationId:new forms_1.FormControl("",forms_1.Validators.required),description:new forms_1.FormControl(""),currentUserId:new forms_1.FormControl(""),equipmentModelId:new forms_1.FormControl("",forms_1.Validators.required)})},e.prototype.addNew=function(){$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#equipmentId").focus()}),this.reset(),this.getCalibration(),this.getLocations(),this.getEquipmentModels(),this.getUserAll()},e.prototype.getAll=function(){var t=this;this.loading=!0,this._dataService.getAll(this._getUrl).subscribe(function(e){t.equipments=e,t.loading=!1},function(e){console.log(e)})},e.prototype.edit=function(e,t){var i=this;this.loading=!0,e.preventDefault(),this.getCalibration(),this.getLocations(),this.getEquipmentModels(),this.getUserAll(),this._dataService.getById(t.id,this._getbyIdUrl).subscribe(function(e){console.log(e),i.equipment=e,i.equipmentForm.setValue({id:i.equipment.id,equipmentId:i.equipment.equipmentId,calibrationId:i.equipment.calibrationId,equipmentName:i.equipment.equipmentName,description:i.equipment.description,serialPortUSB:i.equipment.serialPortUSB,equipmentModelId:i.equipment.equipmentModelId,permanentLocationId:i.equipment.permanentLocationId,currentUserId:i.equipment.currentUserId}),i.loading=!1,$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#equipmentId").focus()})},function(e){console.log(e)})},e.prototype.onChangeSearchText=function(e){var t;"/backoffice/equipment/equipments"==this.router.url&&(t=document.getElementById("searchText").value,this.getEquipments(e,t))},e.prototype.getEquipments=function(e,t){var i=this;this.loading=!0,this._dataService.getByText(t,this._getbyEquipmentIdUrl).subscribe(function(e){i.equipments=e,i.loading=!1},function(e){console.log(e)})},e.prototype.onSubmit=function(){var e,t=this;this.loading=!0,this.equipmentForm.invalid||((e=new FormData).append("id",this.equipmentForm.value.id),e.append("equipmentId",this.equipmentForm.value.equipmentId),e.append("equipmentName",this.equipmentForm.value.equipmentName),e.append("calibrationId",this.equipmentForm.value.calibrationId),e.append("description",this.equipmentForm.value.description),e.append("serialPortUSB",this.equipmentForm.value.serialPortUSB),e.append("equipmentModelId",this.equipmentForm.value.equipmentModelId),e.append("permanentLocationId",this.equipmentForm.value.permanentLocationId),e.append("currentUserId",this.equipmentForm.value.currentUserId),this._dataService.saveWithUser(this.equipmentForm.value,this.loggedUser,this._saveUrl).subscribe(function(e){t.resmessage=e.message,t.alertmessage="alert-outline-info",t.getAll(),t.reset(),$("#largesizemodal").modal("hide"),t.loading=!1},function(e){console.log(e)}))},e.prototype.updateStatus=function(e,t){var i=this;this.loading=!0,e.preventDefault(),this._dataService.updateStatus(t,this.loggedUser,this._updateUrl).subscribe(function(e){i.resmessage=e.message,i.alertmessage="alert-outline-info",i.getAll(),i.reset(),i.loading=!1,$("#defaultsizemodal").modal("hide")},function(e){console.log(e),i.loading=!1}),this.loading=!1},e.prototype.delete=function(e,t){var i=this;this.loading=!0,e.preventDefault(),confirm("You are about to delete "+t.equipmentName+". Are you sure?")&&this._dataService.delete(t.id,this._deleteUrl).subscribe(function(e){i.loading=!1,i.resmessage=e,i.getAll()},function(e){console.log(e)})},e.prototype.getCalibration=function(){var t=this;this.loading=!0,this._dataService.getAll(this._getCalibrationUrl).subscribe(function(e){t.calibrations=e,t.loading=!1},function(e){console.log(e)})},e.prototype.getEquipmentModels=function(){var t=this;this.loading=!0,this._dataService.getAll(this._getEquipmentModelUrl).subscribe(function(e){t.equipmentModels=e,t.loading=!1},function(e){console.log(e)})},e.prototype.getLocations=function(){var t=this;this.loading=!0,this._dataService.getAll(this._getLocationUrl).subscribe(function(e){t.locations=e,t.loading=!1},function(e){console.log(e)})},e.prototype.getUserAll=function(){var t=this;this.loading=!0,this._dataService.getAll(this._getUserUrl).subscribe(function(e){t.users=e,console.log(t.users),t.loading=!1},function(e){console.log(e)})},e.prototype.reset=function(){this.equipmentForm.setValue({id:0,equipmentId:"",equipmentName:"",calibrationId:0,description:"",serialPortUSB:"",equipmentModelId:0,permanentLocationId:0,currentUserId:0}),this.resmessage=null,$("#equipmentId").focus()},__decorate([core_1.ViewChild("fileInput"),__metadata("design:type",core_1.ElementRef)],e.prototype,"fileInput",void 0),__decorate([core_1.Component({selector:"ng-equipments",templateUrl:"./app/backoffice/equipment/equipments/component.html",providers:[service_1.DataService]}),__metadata("design:paramtypes",[http_1.Http,router_1.Router,platform_browser_1.Title,forms_1.FormBuilder,service_1.DataService])],e)}();exports.EquipmentsComponent=EquipmentsComponent;