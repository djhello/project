"use strict";var __decorate=this&&this.__decorate||function(t,e,o,r){var i,a=arguments.length,s=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,r);else for(var n=t.length-1;0<=n;n--)(i=t[n])&&(s=(a<3?i(s):3<a?i(e,o,s):i(e,o))||s);return 3<a&&s&&Object.defineProperty(e,o,s),s},__metadata=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),forms_1=require("@angular/forms"),http_1=require("@angular/http"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),service_1=require("../../../shared/service"),CapacitorComponent=function(){function t(t,e,o,r,i){this._http=t,this.router=e,this.titleService=o,this.formBuilder=r,this._dataService=i,this.loading=!1,this._getUrl="/api/Capacitor/getAll",this._getbyIdUrl="/api/capacitor/getbyid",this._saveUrl="/api/capacitor/save",this._deleteUrl="/api/capacitor/deletebyid",this._updateUrl="/api/capacitor/updateStatus",this._getLocationUrl="/api/location/getall",this._getProjectUrl="/api/project/getall",this.loggedUser=JSON.parse(localStorage.getItem("loggedUser"))}return t.prototype.ngOnInit=function(){this.titleService.setTitle("Envanter Takip Sistemi | Capacitor"),this.loadScripts(),this.createForm(),this.getAll()},t.prototype.loadScripts=function(){for(var t=["assets/js/datepicker-init.js"],e=0;e<t.length;e++){var o=document.createElement("script");o.src=t[e],o.type="text/javascript",o.async=!1,o.charset="utf-8",document.getElementsByTagName("body")[0].appendChild(o)}},t.prototype.createForm=function(){this.capacitorForm=this.formBuilder.group({id:0,locationId:new forms_1.FormControl(""),port:new forms_1.FormControl(""),TeiPartNumber:new forms_1.FormControl(""),description:new forms_1.FormControl(""),supplier:new forms_1.FormControl(""),SPN:new forms_1.FormControl(""),quantity:new forms_1.FormControl(""),MFPN:new forms_1.FormControl(""),projectId:new forms_1.FormControl("")})},t.prototype.addNew=function(){this.getLocations(),this.getProjects(),$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#port").focus()}),this.reset()},t.prototype.getAll=function(){var e=this;this.loading=!0,this._dataService.getTestall(this._getUrl).subscribe(function(t){e.capacitors=t,console.log(t)},function(t){console.log(t)}),this.loading=!1},t.prototype.edit=function(t,e){var o=this;t.preventDefault(),this.getLocations(),this.getProjects(),this.loading=!0,this._dataService.getbyid(e.id,this._getbyIdUrl).subscribe(function(t){o.loading=!1,o.capacitor=t,o.capacitorForm.setValue({id:o.capacitor.id,locationId:o.capacitor.locationId,port:o.capacitor.port,TeiPartNumber:o.capacitor.teiPartNumber,description:o.capacitor.description,supplier:o.capacitor.supplier,SPN:o.capacitor.spn,quantity:o.capacitor.quantity,MFPN:o.capacitor.mfpn,projectId:o.capacitor.projectId}),$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#name").focus()})},function(t){console.log(t)})},t.prototype.onSubmit=function(){var t,e=this;this.loading=!0,this.capacitorForm.invalid||((t=new FormData).append("id",this.capacitorForm.value.id),t.append("locationId",this.capacitorForm.value.locationId),t.append("port",this.capacitorForm.value.port),t.append("TeiPartNumber",this.capacitorForm.value.TeiPartNumber),t.append("description",this.capacitorForm.value.description),t.append("supplier",this.capacitorForm.value.supplier),t.append("SPN",this.capacitorForm.value.SPN),t.append("quantity",this.capacitorForm.value.quantity),t.append("MFPN",this.capacitorForm.value.MFPN),t.append("projectId",this.capacitorForm.value.projectId),this._dataService.saveWithUser(this.capacitorForm.value,this.loggedUser,this._saveUrl).subscribe(function(t){e.loading=!1,e.resmessage=t.message,e.alertmessage="alert-outline-info",e.getAll(),$("#largesizemodal").modal("hide")},function(t){console.log(t)}))},t.prototype.updateStatus=function(t,e){var o=this;this.loading=!0,t.preventDefault(),confirm("You are about to delete "+e.description+". Are you sure?")&&this._dataService.updateStatus(e,this.loggedUser,this._updateUrl).subscribe(function(t){o.resmessage=t.message,o.alertmessage="alert-outline-info",o.getAll(),o.reset(),o.loading=!1,$("#defaultsizemodal").modal("hide")},function(t){console.log(t),o.loading=!1}),this.loading=!1},t.prototype.getLocations=function(){var e=this;this.loading=!0,this._dataService.getall(this._getLocationUrl).subscribe(function(t){e.locations=t,e.loading=!1},function(t){console.log(t)})},t.prototype.getProjects=function(){var e=this;this.loading=!0,this._dataService.getall(this._getProjectUrl).subscribe(function(t){e.projects=t,e.loading=!1},function(t){console.log(t)})},t.prototype.delete=function(t,e){var o=this;this.loading=!0,t.preventDefault(),confirm("You are about to delete "+e.description+". Are you sure?")&&this._dataService.delete(e.id,this._deleteUrl).subscribe(function(t){o.loading=!1,o.resmessage=t,o.getAll()},function(t){console.log(t)})},t.prototype.reset=function(){this.capacitorForm.setValue({id:0,locationId:0,port:null,TeiPartNumber:null,description:null,supplier:null,SPN:null,quantity:0,MFPN:null,projectId:0}),this.resmessage=null,$("#name").focus()},__decorate([core_1.Component({selector:"ng-capacitor",templateUrl:"./app/backoffice/equipment/capacitor/component.html",providers:[service_1.DataService]}),__metadata("design:paramtypes",[http_1.Http,router_1.Router,platform_browser_1.Title,forms_1.FormBuilder,service_1.DataService])],t)}();exports.CapacitorComponent=CapacitorComponent;