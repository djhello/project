"use strict";var __decorate=this&&this.__decorate||function(e,t,o,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var n=e.length-1;0<=n;n--)(i=e[n])&&(s=(a<3?i(s):3<a?i(t,o,s):i(t,o))||s);return 3<a&&s&&Object.defineProperty(t,o,s),s},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),forms_1=require("@angular/forms"),http_1=require("@angular/http"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),service_1=require("../../../shared/service"),TestsComponent=function(){function e(e,t,o,r,i){this._http=e,this.router=t,this.titleService=o,this.formBuilder=r,this._dataService=i,this.loading=!1,this._getUrl="/api/test/getall",this._getbyIdUrl="/api/test/getbyid",this._saveUrl="/api/test/save",this._deleteUrl="/api/test/deletebyid",this._getcalibrationUrl="/api/dropdown/getallauthor",this._getcategoryUrl="/api/dropdown/getallcategory";i=JSON.parse(localStorage.getItem("loggedUser"));this.loggedUsername=i.displayname,this.loggedemail=i.email,this.loggedUsertype=i.usertype}return e.prototype.ngOnInit=function(){this.titleService.setTitle("Envanter Takip Sistemi | test"),this.loadScripts(),this.createForm(),this.getAll(),1!=this.loggedUsertype&&(localStorage.removeItem("isLoggedin"),localStorage.removeItem("loggedUser"),this.router.navigate(["/login"]))},e.prototype.loadScripts=function(){for(var e=["assets/js/datepicker-init.js"],t=0;t<e.length;t++){var o=document.createElement("script");o.src=e[t],o.type="text/javascript",o.async=!1,o.charset="utf-8",document.getElementsByTagName("body")[0].appendChild(o)}},e.prototype.createForm=function(){this.testForm=this.formBuilder.group({id:0,name:new forms_1.FormControl("",forms_1.Validators.required),date:new forms_1.FormControl("")})},e.prototype.addNew=function(){$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#bookName").focus()}),this.reset(),this.getcalibration(),this.getcategory()},e.prototype.getAll=function(){var t=this;this._dataService.getall(this._getUrl).subscribe(function(e){t.tests=e},function(e){console.log(e)})},e.prototype.edit=function(e,t){var o=this;e.preventDefault(),this.getcalibration(),this.getcategory(),this._dataService.getbyid(t.id,this._getbyIdUrl).subscribe(function(e){o.test=e,o.testForm.setValue({id:o.test.id,name:o.test.name,date:o.test.date}),$("#largesizemodal").modal("show"),$("#largesizemodal").on("shown.bs.modal",function(){$(this).find("#testName").focus()})},function(e){console.log(e)})},e.prototype.onSubmit=function(){var e,t=this;this.testForm.invalid||((e=new FormData).append("id",this.testForm.value.id),e.append("name",this.testForm.value.name),e.append("date",this.testForm.value.date),this._dataService.saveForm(e,this._saveUrl).subscribe(function(e){t.resmessage=e.message,t.alertmessage="alert-outline-info",t.getAll(),t.reset()},function(e){console.log(e)}))},e.prototype.delete=function(e,t){var o=this;e.preventDefault(),confirm("You are about to delete "+t.bookname+". Are you sure?")&&this._dataService.delete(t.id,this._deleteUrl).subscribe(function(e){o.resmessage=e,o.getAll()},function(e){console.log(e)})},e.prototype.getcalibration=function(){var t=this;this._dataService.getall(this._getcalibrationUrl).subscribe(function(e){t.calibrations=e},function(e){console.log(e)})},e.prototype.getcategory=function(){var t=this;this._dataService.getall(this._getcategoryUrl).subscribe(function(e){console.log(e),t.categories=e},function(e){console.log(e)})},e.prototype.reset=function(){this.testForm.setValue({id:0,name:null,date:null}),this.fileInput.nativeElement.value="",this.resmessage=null,$("#bookName").focus()},__decorate([core_1.ViewChild("fileInput"),__metadata("design:type",core_1.ElementRef)],e.prototype,"fileInput",void 0),__decorate([core_1.Component({selector:"ng-test",templateUrl:"./app/backoffice/equipment/test/component.html",providers:[service_1.DataService]}),__metadata("design:paramtypes",[http_1.Http,router_1.Router,platform_browser_1.Title,forms_1.FormBuilder,service_1.DataService])],e)}();exports.TestsComponent=TestsComponent;