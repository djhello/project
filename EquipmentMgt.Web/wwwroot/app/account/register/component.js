"use strict";var __decorate=this&&this.__decorate||function(e,r,t,o){var a,s=arguments.length,i=s<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,o);else for(var l=e.length-1;0<=l;l--)(a=e[l])&&(i=(s<3?a(i):3<s?a(r,t,i):a(r,t))||i);return 3<s&&i&&Object.defineProperty(r,t,i),i},__metadata=this&&this.__metadata||function(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),forms_1=require("@angular/forms"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),service_1=require("../../shared/service"),confirmed_validator_1=require("../../shared/confirmed.validator"),bcrypt=require("bcryptjs"),saltround=10,RegisterComponent=function(){function e(e,r,t,o){this.router=e,this.titleService=r,this.formBuilder=t,this._dataService=o,this.loading=!1,this._saveUrl="/api/auth/regusers",this._getDepartmanUrl="/api/departman/getAll"}return e.prototype.ngOnInit=function(){this.titleService.setTitle("Envanter Takip Sistemi | Register"),this.createForm(),this.loggedUser=JSON.parse(localStorage.getItem("loggedUser")),this.getDepartmanAll()},e.prototype.createForm=function(){this.userForm=this.formBuilder.group({userId:new forms_1.FormControl("",forms_1.Validators.required),departmanId:new forms_1.FormControl("",forms_1.Validators.required),firstName:new forms_1.FormControl("",forms_1.Validators.required),lastName:new forms_1.FormControl("",forms_1.Validators.required),email:new forms_1.FormControl("",forms_1.Validators.compose([forms_1.Validators.required,forms_1.Validators.pattern("^[a-zA-Z0-9_.+-]+@tei.com.tr+$")])),password:new forms_1.FormControl("",forms_1.Validators.required),confirmPassword:new forms_1.FormControl("",forms_1.Validators.required)},{validator:confirmed_validator_1.ConfirmedValidator("password","confirmPassword")}),$("#userId").focus()},e.prototype.getDepartmanAll=function(){var r=this;this.loading=!0,this._dataService.getAll(this._getDepartmanUrl).subscribe(function(e){r.loading=!1,r.departmans=e},function(e){console.log(e)})},e.prototype.onSubmit=function(){var t=this;this.userForm.invalid||bcrypt.hash(this.userForm.value.password,saltround,function(e,r){e?console.log("hata geldi"):(t.loading=!0,t._dataService.save({userId:t.userForm.value.userId,departmanId:t.userForm.value.departmanId,firstName:t.userForm.value.firstName,lastName:t.userForm.value.lastName,email:t.userForm.value.email,password:r},t._saveUrl).subscribe(function(e){t.loading=!1,t.resmessage=e.message,t.alertmessage="alert-outline-info","Saved Successfully."==t.resmessage&&t.reset()},function(e){}))})},e.prototype.reset=function(){this.userForm.setValue({firstName:null,lastName:null,userId:null,departmanId:null,email:null,password:null,confirmPassword:null})},__decorate([core_1.Component({selector:"app-register",templateUrl:"./app/account/register/component.html",providers:[service_1.DataService]}),__metadata("design:paramtypes",[router_1.Router,platform_browser_1.Title,forms_1.FormBuilder,service_1.DataService])],e)}();exports.RegisterComponent=RegisterComponent;